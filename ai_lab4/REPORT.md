# Отчёт по лабораторной работе
## Свёрточные нейронные сети

### Студенты: 

| ФИО       | Роль в проекте                     | Оценка       |
|-----------|------------------------------------|--------------|
| Степанов Д. | Реализовал часть 1 и помогал по части 3  |       |
| Тихонов Ф.| Реализовал часть 2 |      |
| Зайцев К. | Реализовал часть 3 |          |

# 1. Сверточная нейронная сеть.

Для изучения компьютерного зрения стоит начать с самого простого: сделать свою нейросеть, для изучения различных свёрток и пуллингов.

Сперва начнём с задачи бинарной классификации.

Архитектура, предложенная нашей командой, довольна проста: сначала по трём каналам (RGB) проходит свёртка с ядром 6 и страйдом 3. Затем тензоры проходят через max pooling, потом опять свёртка, но уже с большим ядром и по 6 каналам, потом опять max pooling. У нас получается 12 характеристический карт, каждая размером 13x13. Потом идёт линейный слой с 128 картами признаков, а потом опять линейный слой с двумя выходами.
Дальше обучим нашу модель на 10 эпохах. У нас получилась довольно неплохая точность на валидационной выборке. 

Затем используем точно такую же архитектуру, но изменим последний слой модели под задачу многоклассовой классификации, сделав 35 выходов. Обучаем модель, оптимизируем гиперпараметры. Получаем top3_score 0.6128. Что довольно неплохо для такой простой модели.

По итогу мы получили нейронную сеть, которая решает задачу многоклассовой классификации с очень средней точностью

# 2. Transfer learning

Казалось бы, чутка усложнив модель, добавив больше слоёв для выделения признаков, и мы должны получить хорошую точность. Но на деле всё обстоит не так. Датасет PetFaces довольно простой: изображение центрировано, уже выделено лицо животного, хорошее освещение изображений, да ещё большое количество свёрток приведёт к тому, что число весов будет очень большим. То есть, простая модель даст хорошую точность только в тепличных условиях. Нас же интересует высокая точность на всевозможных изображениях. Для получения высокой точности сложные нейронные сети оптимизируют свёрточные слои(берутся свёртки 3x3, следующих один за одним), но это влечёт за собой большую глубину, увеличивающую время обучения и расходуемую память, тогда на помощь приходят Inception блоки различных архтитектур и др. И вместо реализации таких сложных вещей куда проще воспользоваться Transfer Learning. Его принципом является распространение знаний предобученной модели на новую задачу. Главными аспектами Transfer learning являются: выделение признаков и дообучение. Мы использовали дообучение модели. Лучший результат показала ResNet, что собственно и было очевидно: она использует Inception-блоки, которые оптимизируют работу с памятью, сохраняя объём сложности вычислений; Bottleneck-и, уменьшающие количество свойств перед передачей в сверточные модули, что сокращает объём вычислений.

# 3. Генерация изображений

Вот мы и подошли к самому интересному. Генерация изображений --- очень увлекательное и весёлое занятие. Его можно использовать для создания смешных картинок. И всё? Какой тогда научный интерес к этой области искуственного интеллекта, если это просто детская забава? Всё обстоит куда сложнее: генерацию изображений можно использовать для создания логотипов, скетчей, раскадровок и т.д., но самое важное (лично для меня) --- это использование генерации изображения для увеличения плавности изображения. Нейросеть либо накладывает два кадра друг на друга(усреднение кадров) или сперва делит кадр на множество блоков, далее оценивает вектор движения каждого блока, либо интерполирует промежуточные кадры. Вот так мы и подошли к технологии DLSS, позволившая многим поиграть в Cyberpunk 2077 с хорошей графикой. Она в реальном времени генерирует дополнительные кадры при помощи ИИ, благодаря чему повышается кадровая частота в играх. Время генерации кадра при этом очень маленькое. 

Теперь попробуем сами сгенерировать лица собак и кошек с помощью нейросети. Есть несколько архитектур генераторов.

Первая --- автоэнкодер. В нём есть 2 составляющие: кодировщик, который сжимает входные данные в вектор латентного пространства, и декодировщик, который декодирует вектор в новое изображение. Сначала наша команда делали VAE --- вариационный автоэнкодер. В нём получается не просто вектор в латентном пространстве, а вектор с некоторым шумом, что делает латентное пространство непрерывным. У обычного автоэнкодера скрытое пространство, в котором они кодируют данные, и в котором лежат их закодированные векторы, может не быть непрерывным и не позволять производить интерполяцию. Но наш VAE не мог нормально обучиться: изображения выходили слишком размытые. Тогда мы сделали генеративно-состязательную сеть

GAN тоже состоит из двух частей. Дискриминатор сопоставляет образы с категорией. Он занят только этой корреляцией. Генератор занят обратным. Вместо того, чтобы предсказывать категорию по имеющимся образам, он пытается подобрать образы к данной категории. Одна нейронная сеть, называемая генератором, генерирует новые экземпляры данных, а другая — дискриминатор, оценивает их на подлинность; т.е. дискриминатор решает, относится ли каждый экземпляр данных, который он рассматривает, к набору тренировочных данных или нет. В итоге мы получили сносный результат. Довольно занятным можно увидеть то, что лица котов получаются лучше. Как мне кажется, это связано с тем, что на фотографиях из датасета кошки в основном встречаются с закрытым ртом, а собаки высовывают язык на некоторых изображениях.

# Вывод

Проделав такую интересную работу, мы освоили сразу несколько различных разделов нейронных сетей: свёрточные нейронные сети, transfer learning и обработка изображений. Нам данная лабораторная понравилась больше всего. Обработка изображений --- очень интересная, перспективная и быстроразвивающаяся отрасль. Её приминения безграничны: от науки до компьютерных игр. Поэтому мы постарались как можно более подробно изучить архитектуры нейронных различных свёрточных сетей и генераторов изображений. Думаю, в свободное время у нас получится решить проблему с VAE, мы улучшим архитектуру и попробуем научиться генерировать изображения людей или персонажей из аниме.

